services:
  - type: web
    name: mMindful_Moments_1.0
    env: python
    plan: free
    port: 5432

    build:
      - pip install -r requirements.txt
      - flask db migrate 
      - flask db upgrade

    startCommand: gunicorn wsgi:app
    repo: https://github.com/Freedomwithin/Mindful_Moments

    envVars:
      - key: SECRET_KEY
        value: Jht8k8bsgGrYc5wtyLV8pWVqclwqSc1b # Replace with a *strong*, random secret key
      - key: DATABASE_URL  # This is where Render will inject the connection string
        value: ${DATABASE_URL}

    healthCheckPath: /ping
    forwardLogs: true

    autoscaling:
      minReplicas: 1
      maxReplicas: 3
      targetCPUPercentage: 75

databases:
  - name: mindful-moments-db # This name is for Render's internal use
    plan: free
    type: postgres
    # databaseName: mindful_moments # If you upgrade to a paid plan, you'll likely use these.
    # user: mindful_moments_user
    # password: YourStrongPassword # Never put a real password here in production!